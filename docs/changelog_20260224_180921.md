# clarc — Daily Activity from Session Data + Full Date/Time

**Date**: 2026-02-24

## Change 1: Compute Daily Activity from Actual Session Data

Previously, the Daily Activity table and dashboard chart used `dailyActivity` from Claude Code's `stats-cache.json`, which only had 2 incomplete entries (Jan 14-15). Now clarc computes daily activity and cost-by-day directly from session timestamps in the indexed data.

- Added `startedAt` field to `SessionRef` — extracted from the first message timestamp during scanning
- Analytics route aggregates sessions by date to produce `dailyActivity` and `costByDay`
- Same pattern as the existing cost/token overrides (session data replaces stats-cache)
- The `/api/analytics/cost` endpoint also uses session-derived `costByDay`
- Fallback: if a session has no `startedAt`, uses `modifiedAt` (file modification time)

## Change 2: Full Date + Time on Message Blocks

Message timestamps now show the date alongside the time.

- Before: `3:45 PM`
- After: `Feb 24, 3:45 PM`

Applies to all message blocks in session and agent detail views.

---

## File Change Summary

### Modified Files (4)

| File | Changes |
|------|---------|
| `src/shared/types.ts` | Added `startedAt?: Date` to `SessionRef` interface |
| `src/data/scanner.ts` | Extract first message timestamp as `startedAt` |
| `src/server/routes/analytics.ts` | Compute `dailyActivity` + `costByDay` from session data; updated `/cost` route |
| `src/ui/components/MessageRenderer.tsx` | Changed time format to include month and day |
